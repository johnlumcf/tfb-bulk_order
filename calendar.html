<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sync Calendar</title>
    <style>
        body { font-family: -apple-system, system-ui, sans-serif; display: flex; flex-direction: column; align-items: center; justify-content: center; height: 100vh; background: #f2f2f7; margin: 0; padding: 20px; text-align: center; }
        .card { background: white; padding: 40px 30px; border-radius: 24px; box-shadow: 0 10px 30px rgba(0,0,0,0.1); width: 100%; max-width: 350px; }
        h1 { margin: 0 0 10px 0; color: #1c1c1e; font-size: 22px; }
        p { color: #8e8e93; margin-bottom: 30px; font-size: 15px; }
        
        .btn { 
            background: #007AFF; color: white; padding: 18px 0; 
            border-radius: 16px; text-decoration: none; font-weight: 700; 
            display: block; width: 100%; font-size: 18px; 
            box-shadow: 0 4px 10px rgba(0,122,255,0.3);
        }
        .btn:active { transform: scale(0.98); }
    </style>
</head>
<body>

    <div class="card">
        <h1 id="title">Loading...</h1>
        <p id="loc">Please wait</p>
        
        <!-- Button links to Google Script File Generator -->
        <a id="downloadBtn" href="#" class="btn">Add to Calendar</a>
    </div>

    <script>
        // 1. Get Params
        const params = new URLSearchParams(window.location.search);
        const title = params.get('t') || "Order";
        const desc = params.get('d') || "";
        const loc = params.get('loc') || "";
        const dateStr = params.get('dt');

        // 2. Update UI
        document.getElementById('title').innerText = title;
        document.getElementById('loc').innerText = loc ? "üìç " + loc : "Syncing...";

        // 3. BUILD THE DOWNLOAD LINK (Using your Google Script)
        
        // ‚ö†Ô∏è PASTE YOUR GOOGLE DEPLOYMENT URL HERE ‚ö†Ô∏è
        const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbwj4_lKSrs-N1yT5w700llOaDx_ZftqvLyLdjRkPKqDVmIVO_STod19okAcI9g22XWMlw/exec"; 
        
        if (dateStr) {
            const fileUrl = SCRIPT_URL + 
                "?mode=ics" +
                "&title=" + encodeURIComponent(title) +
                "&desc=" + encodeURIComponent(desc) +
                "&loc=" + encodeURIComponent(loc) +
                "&date=" + encodeURIComponent(dateStr);

            document.getElementById('downloadBtn').href = fileUrl;
        }
    </script>
</body>
</html>
